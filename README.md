# FinBot ‚Äî —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç (pyTelegramBotAPI)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `/start`.
- –ö–Ω–æ–ø–∫–∏ –¥–ª—è –±–∞–Ω–∫–æ–≤ —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º–∏ URL –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ê–¥–º–∏–Ω—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ `/stats` (–∏–ª–∏ `/admin_stats`).
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin` –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫.
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤ –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.
- –ó–∞–ø—Ä–æ—Å –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã (—Ç–µ–ª–µ—Ñ–æ–Ω, –∏–º—è, —Ñ–∞–º–∏–ª–∏—è).
- SQLite —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.10+
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:
  - `TELEGRAM_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–¥–µ)
  - `DATABASE_PATH` ‚Äî –ø—É—Ç—å –∫ SQLite —Ñ–∞–π–ª—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `bot.sqlite3`)
  - `ADMIN_IDS` ‚Äî Telegram ID –∞–¥–º–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `123,456`) –¥–ª—è `/stats` –∏ `/admin`
  - `TELEGRAM_PROXY` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, proxy URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Telegram API (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://user:pass@host:port`)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
# –∑–∞—Ç–µ–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env
python init_db.py
python main.py
```

## –°—Ö–µ–º–∞ –ë–î (SQLite)
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    tg_id INTEGER UNIQUE NOT NULL,
    username TEXT,
    first_name TEXT,
    last_name TEXT,
    created_at TEXT NOT NULL
);

CREATE TABLE referrals (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    referrer_id INTEGER NOT NULL,
    referred_id INTEGER UNIQUE NOT NULL,
    bank_key TEXT NOT NULL,
    created_at TEXT NOT NULL,
    FOREIGN KEY(referrer_id) REFERENCES users(id),
    FOREIGN KEY(referred_id) REFERENCES users(id)
);

CREATE TABLE banks (
    key TEXT PRIMARY KEY,
    base_url TEXT NOT NULL
);

CREATE TABLE reward_requests (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    bank_key TEXT NOT NULL,
    phone TEXT NOT NULL,
    first_name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    status TEXT NOT NULL,
    created_at TEXT NOT NULL,
    FOREIGN KEY(user_id) REFERENCES users(id)
);
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
### –í–Ω–µ—à–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏
–ö–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ –≤–∏–¥–∞:
```
{bank_base_url}?ref={telegram_id}
```
–ö–æ–¥–æ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è —Å–ª—É–∂–∏—Ç Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–∞–Ω–∫—É –æ—Ç—Å–ª–µ–¥–∏—Ç—å, –∫—Ç–æ –ø—Ä–∏–≥–ª–∞—Å–∏–ª.

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/stats` ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ `ADMIN_IDS`.
- –î–ª—è CSV –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `/stats csv`.

## –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
–ö–æ–º–∞–Ω–¥–∞ `/admin` (–¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ `ADMIN_IDS`) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é:
- —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞;
- —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö URL —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –±–∞–Ω–∫–æ–≤;
- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤.
–†–∞–∑–¥–µ–ª **üìã –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ** ‚Äî –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫. –í –∫–∞—Ä—Ç–æ—á–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–Ω–æ–ø–∫–∏ **‚úÖ –ü—Ä–∏–Ω—è—Ç—å** –∏ **‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å**.
–†–∞–∑–¥–µ–ª **üóÇÔ∏è –ò—Å—Ç–æ—Ä–∏—è –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–∏–Ω—è—Ç—ã–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–Ω–æ–ø–∫–∏ **–ù–∞–∑–∞–¥** –∏ **–û—Ç–º–µ–Ω–∞**, —á—Ç–æ–±—ã –ø—Ä–µ—Ä–≤–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–µ–Ω—é.

## –ó–∞–ø—Ä–æ—Å –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è
–ù–∞ —ç–∫—Ä–∞–Ω–µ `/start` –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ **üéÅ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ**. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç:
1. –±–∞–Ω–∫;
2. —Ç–µ–ª–µ—Ñ–æ–Ω;
3. –∏–º—è;
4. —Ñ–∞–º–∏–ª–∏—é.
–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∑–∞–ø—Ä–µ—â—ë–Ω, –ø–æ–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å `pending`.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   - `/stats` –∏–ª–∏ `/stats csv`.

## –ì–¥–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏ –±–∞–Ω–∫–æ–≤
–ë–∞–∑–æ–≤—ã–µ URL –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —á–µ—Ä–µ–∑ `/admin`. URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º —Å `http://` –∏–ª–∏ `https://`. –ò—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `models.py` –≤ `DEFAULT_BANKS`.

## –û—à–∏–±–∫–∞ ProxyError –ø—Ä–∏ polling
–ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É –≤–∏–¥–∞ `ProxyError` –∏–ª–∏ `Remote end closed connection without response`,
–∑–Ω–∞—á–∏—Ç –¥–æ—Å—Ç—É–ø –∫ `api.telegram.org` –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏/—Ñ–∞–µ—Ä–≤–æ–ª–æ–º. –£–∫–∞–∂–∏—Ç–µ –ø—Ä–æ–∫—Å–∏ —á–µ—Ä–µ–∑ `TELEGRAM_PROXY`:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
TELEGRAM_PROXY="http://user:pass@host:port"
```
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –±–æ—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram API.
